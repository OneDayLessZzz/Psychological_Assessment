<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>分离性体验量表（DES-II）在线评估</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            font-size: 14px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(45deg, #4a90e2, #357abd);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 1.8em;
            margin-bottom: 10px;
            font-weight: 300;
        }
        
        .header p {
            font-size: 1em;
            opacity: 0.9;
        }
        
        .content {
            padding: 30px;
        }
        
        .info-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 4px solid #4a90e2;
        }
        
        .patient-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .input-group {
            display: flex;
            flex-direction: column;
        }
        
        .input-group label {
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .input-group input {
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #4a90e2;
        }
        
        .instructions {
            background: #fff3cd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border: 1px solid #ffeeba;
        }
        
        .instructions h3 {
            color: #856404;
            margin-bottom: 10px;
        }
        
        .question {
            background: white;
            margin-bottom: 20px;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            border: 1px solid #e9ecef;
        }
        
        .question h4 {
            margin-bottom: 15px;
            color: #495057;
            font-weight: 500;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .scale-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .scale-option {
            display: flex;
            flex-direction: column;
            align-items: center;
            min-width: 60px;
        }
        
        .scale-option input[type="radio"] {
            width: 20px;
            height: 20px;
            margin-bottom: 5px;
            cursor: pointer;
        }
        
        .scale-option label {
            font-size: 11px;
            text-align: center;
            cursor: pointer;
            color: #666;
        }
        
        .scale-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 11px;
            color: #666;
        }
        
        .button-container {
            text-align: center;
            margin: 30px 0;
        }
        
        .btn {
            background: linear-gradient(45deg, #4a90e2, #357abd);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 10px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .results {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
            display: none;
        }
        
        .score-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .score-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .score-value {
            font-size: 2.5em;
            font-weight: bold;
            color: #4a90e2;
            margin-bottom: 10px;
        }
        
        .score-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }
        
        .factor-scores {
            margin-top: 30px;
        }
        
        .factor-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        
        .factor-title {
            font-size: 18px;
            font-weight: bold;
            color: #495057;
            margin-bottom: 10px;
        }
        
        .factor-score {
            font-size: 24px;
            font-weight: bold;
            color: #4a90e2;
            float: right;
        }
        
        .factor-description {
            color: #666;
            margin-top: 10px;
            clear: both;
        }
        
        .interpretation {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
        }
        
        .norm-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .norm-table th,
        .norm-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .norm-table th {
            background-color: #f8f9fa;
            font-weight: bold;
        }
        
        .highlight {
            background-color: #fff3cd !important;
            font-weight: bold;
        }
        
        .warning {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid #f5c6cb;
        }
        
        @media (max-width: 768px) {
            body {
                font-size: 12px;
                padding: 10px;
            }
            
            .header h1 {
                font-size: 1.5em;
            }
            
            .header p {
                font-size: 0.9em;
            }
            
            .content {
                padding: 20px;
            }
            
            .question h4 {
                font-size: 13px;
            }
            
            .scale-container {
                justify-content: center;
                gap: 5px;
            }
            
            .scale-option {
                min-width: 40px;
            }
            
            .scale-option label {
                font-size: 10px;
            }
            
            .scale-labels {
                font-size: 10px;
            }
            
            .score-summary {
                grid-template-columns: 1fr;
            }
            
            .button-container {
                flex-direction: column;
                align-items: center;
            }
            
            .btn {
                margin: 5px 0;
                width: 100%;
                max-width: 300px;
                font-size: 14px;
            }
            
            .factor-title {
                font-size: 16px;
            }
            
            .factor-score {
                font-size: 20px;
            }
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #4a90e2, #357abd);
            width: 0%;
            transition: width 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>分离性体验量表（DES-II）</h1>
            <p>Dissociative Experiences Scale - Version II</p>
        </div>
        
        <div class="content">
            <div class="info-section">
                <h3>基本信息</h3>
                <div class="patient-info">
                    <div class="input-group">
                        <label for="name">姓名：</label>
                        <input type="text" id="name" placeholder="请输入姓名">
                    </div>
                    <div class="input-group">
                        <label for="gender">性别：</label>
                        <input type="text" id="gender" placeholder="男/女/非二元">
                    </div>
                    <div class="input-group">
                        <label for="age">年龄：</label>
                        <input type="number" id="age" placeholder="请输入年龄">
                    </div>
                    <div class="input-group">
                        <label for="education">受教育程度：</label>
                        <input type="text" id="education" placeholder="如：本科">
                    </div>

                </div>
            </div>
            
            <div class="instructions">
                <h3>指导语</h3>
                <p>该问卷包含有28个与您在日常生活中可能出现的体验有关的问题。我们想了解您出现这些体验的频率。但请注意，<strong>在出现这些体验时，您当时没有受到酒精或毒品的影响</strong>。</p>
                <p>在回答这个问卷时，请思考一下每个问题与您的情况相符合的程度。然后在符合您目前情况的数字上选择（"从未有过"为0，"总是这样"为100％）。</p>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            
            <form id="desForm">
                <div id="questions"></div>
                
                <div class="button-container">
                    <button type="button" class="btn" onclick="calculateScore()">计算分数</button>
                    <button type="button" class="btn" onclick="clearForm()">清空重填</button>
                </div>
            </form>
            
            <div class="results" id="results">
                <h3>评估结果</h3>
                
                <div class="score-summary">
                    <div class="score-card">
                        <div class="score-value" id="totalScore">0</div>
                        <div class="score-label">总分</div>
                    </div>
                </div>
                
                <div class="factor-scores">
                    <h4>因子分析结果</h4>
                    
                    <div class="factor-card">
                        <div class="factor-title">失忆性分离 (Amnistic Dissociation)</div>
                        <div class="factor-score" id="factor1Score">0</div>
                        <div class="factor-description">
                            包含题目：3, 4, 5, 6, 8, 10, 25, 26<br>
                            反映对个人经历的遗忘、记忆缺失等现象。
                        </div>
                    </div>
                    
                    <div class="factor-card">
                        <div class="factor-title">专注与想象参与 (Absorption and Imaginative)</div>
                        <div class="factor-score" id="factor2Score">0</div>
                        <div class="factor-description">
                            包含题目：2, 14, 15, 16, 17, 18, 20, 22, 23<br>
                            专注在过去创伤经验中而忽略现在周遭状况，或对记忆的真实性感到不确定。
                        </div>
                    </div>
                    
                    <div class="factor-card">
                        <div class="factor-title">自我感丧失及失真感 (Depersonalization and Derealization)</div>
                        <div class="factor-score" id="factor3Score">0</div>
                        <div class="factor-description">
                            包含题目：7, 11, 12, 13, 27, 28<br>
                            感觉自己或周围环境不真实，或感觉脱离自己的身体和经历。
                        </div>
                    </div>
                </div>
                
                <div class="interpretation">
                    <h4>常模对照</h4>
                    <p style="margin-bottom: 20px; color: #666; font-style: italic;">
                        <strong>重要说明：</strong>以下常模数据仅供参考，不作为诊断依据。DES-II是筛查工具，准确的临床诊断需要结合详细的临床评估和专业判断。总分30分以上提示需要进一步专业评估。
                    </p>
                    <table class="norm-table" id="normTable">
                        <thead>
                            <tr>
                                <th>人群</th>
                                <th>平均分数</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td>一般成人</td><td>5.4</td></tr>
                            <tr><td>焦虑性疾患</td><td>7.0</td></tr>
                            <tr><td>情感性疾患</td><td>9.35</td></tr>
                            <tr><td>饮食疾患</td><td>15.8</td></tr>
                            <tr><td>青少年晚期 (15-18岁)</td><td>16.6</td></tr>
                            <tr><td>知觉失调症</td><td>15.4</td></tr>
                            <tr><td>边缘性人格疾患</td><td>19.2</td></tr>
                            <tr><td>创伤后压力症</td><td>31</td></tr>
                            <tr><td>解离性障碍 (NOS)</td><td>36</td></tr>
                            <tr><td>解离性人格疾患(DID)</td><td>48</td></tr>
                        </tbody>
                    </table>
                    
                    <div id="clinicalNote"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 题目数据 - 使用数组字面量避免兼容性问题
        var questions = [
            "有些人有这样的体验，他们骑着自行车（或开车）走着，突然意识到，怎么自己一点儿也想不起来在整个或部分的行驶过程中发生过什么。",
            "有些人有时正在听某人说话时突然意识到，自己对刚才所谈内容的全部或者部分好像什么也没听见。",
            "有些人有这样的体验，他们突然发现自己到了某个地方，却不知道自己是怎么来的。",
            "有些人有这样的体验，他们注意到自己身上所穿的衣服，却想不起来自己是怎么穿上这身衣服的。",
            "有些人有这样的体验，他们在自己的私人物品中发现了新的物品，可是却记不得这个物品是怎么来的。",
            "有些人有这样的体验，有些他们并不认识的人朝他们走来，这些人用别的名字向他们打招呼或者自称认识他们。",
            "有些人有时有这样的感觉，觉得自己像是站在自己旁边，或者看着自己正在干着什么。他们真的看着自己就好像是看着另外一个人一样。",
            "有些人被告知，有时他们会认不出自己的朋友或家人。",
            "有些人发现他们不记得自己生活中的重要事件了。（例如：婚礼或者毕业典礼。）",
            "有些人自己觉得自己肯定没有撒谎，但别人却责备他们在撒谎。",
            "有些人在照镜子的时候认不出自己了。",
            "有些人有这样的体验，他们觉得自己周围的其他人、物和世界是不真实的。",
            "有些人有这样的感觉，就好像他们的身体不属于他们自己了。",
            "有些人在回忆一件早先经历过的事情时有时会产生很强烈的体验，就好像再次经历了这一生活事件似的。",
            "有些人分不清，有些事情是自己真的经历过，还是自己做的梦。",
            "有些人感觉自己在一个熟悉的地方，却发现这个地方变得陌生和不熟悉。",
            "有些人有这样的体验，当他们看电影或电视时太投入剧情中，以至于感觉不到周遭发生的事情。",
            "有些人在幻想和做白日梦的时候是如此投入，以至于觉得那些就像是真的一样。",
            "有些人有这样的体验，他们有时候能够感觉不到疼痛。",
            "有些人有时就呆呆地注视某一处，既没想任何事情，也感觉不到时间的流逝。",
            "有些人发现，自己有时在独处时出声地跟自己说话。",
            "有些人发现，他们在不同场合的行为举止差别很大，以至于感觉自己就象两个人。",
            "有些人有这样的体验，一些平时感到困难的事情却在特定的情景下能够轻松、自如地完成（如：运动、工作、社交场合）。",
            "有些人有时记不清，某件事情是他们已经做了、还是他们只是想过要去做（如：已经发了一封信或者只是想着要发）。",
            "有些人会从自己身边的一些迹象上发现，自己一定是做了些什么，但对此自己却一点儿印象也没有。",
            "有些人有时候在自己的物品中发现小纸片、图画或者笔记，这些肯定出自自己的手笔，但却怎么也想不起来自己是怎么完成的。",
            "有些人有时听到自己头脑中有一个声音，这个声音会指示他们应该做什么，或者对自己刚做过的事情加以评论。",
            "有些人有时感觉自己好像是在透过一层雾感知着这个世界，所以其他人或物好像离自己很远或者不太清晰。"
        ];

        // 因子分组 - 使用数组字面量
        var factor1Items = [2, 3, 4, 5, 7, 9, 24, 25]; // 失忆性分离 (题目编号-1)
        var factor2Items = [1, 13, 14, 15, 16, 17, 19, 21, 22]; // 专注与想象参与
        var factor3Items = [6, 10, 11, 12, 26, 27]; // 自我感丧失及失真感

        function initForm() {
            var questionsContainer = document.getElementById('questions');
            
            // 简单的循环创建题目
            for (var i = 0; i < questions.length; i++) {
                var questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                // 创建选项
                var optionsHTML = '';
                for (var j = 0; j <= 10; j++) {
                    var value = j * 10;
                    optionsHTML += '<div class="scale-option">';
                    optionsHTML += '<input type="radio" id="q' + (i + 1) + '_' + value + '" name="q' + (i + 1) + '" value="' + value + '" onchange="updateProgress()">';
                    optionsHTML += '<label for="q' + (i + 1) + '_' + value + '">' + value + '%</label>';
                    optionsHTML += '</div>';
                }
                
                // 设置题目内容
                questionDiv.innerHTML = 
                    '<h4>' + (i + 1) + '. ' + questions[i] + '</h4>' +
                    '<div class="scale-container">' + optionsHTML + '</div>' +
                    '<div class="scale-labels">' +
                        '<span>从未有过</span>' +
                        '<span>总是这样</span>' +
                    '</div>';
                
                questionsContainer.appendChild(questionDiv);
            }
        }

        function updateProgress() {
            const totalQuestions = 28;
            const answeredQuestions = document.querySelectorAll('input[type="radio"]:checked').length;
            const progressPercentage = (answeredQuestions / totalQuestions) * 100;
            document.getElementById('progressFill').style.width = progressPercentage + '%';
        }

        function calculateScore() {
            const answers = [];
            let allAnswered = true;
            
            for (let i = 1; i <= 28; i++) {
                const answer = document.querySelector(`input[name="q${i}"]:checked`);
                if (answer) {
                    answers.push(parseInt(answer.value));
                } else {
                    allAnswered = false;
                    break;
                }
            }
            
            if (!allAnswered) {
                alert('请完成所有题目后再计算分数！');
                return;
            }
            
            // 计算总分
            const totalScore = answers.reduce((sum, score) => sum + score, 0) / 28;
            
            // 计算因子分数
            const factor1Score = factor1Items.reduce((sum, item) => sum + answers[item], 0) / factor1Items.length;
            const factor2Score = factor2Items.reduce((sum, item) => sum + answers[item], 0) / factor2Items.length;
            const factor3Score = factor3Items.reduce((sum, item) => sum + answers[item], 0) / factor3Items.length;
            
            // 显示结果
            document.getElementById('totalScore').textContent = totalScore.toFixed(2);
            document.getElementById('factor1Score').textContent = factor1Score.toFixed(2);
            document.getElementById('factor2Score').textContent = factor2Score.toFixed(2);
            document.getElementById('factor3Score').textContent = factor3Score.toFixed(2);
            
            // 解释结果
            let clinicalNote = '';
            
            if (totalScore >= 30) {
                clinicalNote = '<div class="warning"><strong>专业提示：</strong>您的总分为30分或以上，提示存在较明显的分离现象。这些体验可能与创伤经历、应激或其他心理因素有关。<br><br><strong>建议：</strong><br>1. 咨询专业的心理健康工作者进行详细评估<br>2. 排除其他可能的心理健康问题<br>3. 如果影响日常生活，请及时寻求专业帮助<br><br><strong>重要说明：</strong>此量表仅作为筛查工具，不能用于诊断。准确的诊断需要专业临床评估。</div>';
            } else {
                clinicalNote = '<div style="color: #495057; padding: 15px; background: #f8f9fa; border-radius: 8px; margin-top: 20px; border-left: 4px solid #4a90e2;"><strong>评估说明：</strong>您已完成DES-II量表评估。请参考上方的总分和因子得分，以及常模对照表来了解您的分离体验水平。如有疑问或需要进一步评估，建议咨询专业心理健康工作者。</div>';
            }
            
            document.getElementById('clinicalNote').innerHTML = clinicalNote;
            
            // 显示结果（移除高亮功能）
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }

        function clearForm() {
            if (confirm('确定要清空所有填写内容吗？')) {
                document.getElementById('desForm').reset();
                document.querySelectorAll('.input-group input').forEach(input => input.value = '');
                document.getElementById('results').style.display = 'none';
                document.getElementById('progressFill').style.width = '0%';
            }
        }

        // 初始化表单
        document.addEventListener('DOMContentLoaded', initForm);
    </script>
</body>
</html>
